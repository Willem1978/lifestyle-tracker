<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#8b5cf6">
    <title>Lifestyle Score Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .date-navigator { background: white; border-radius: 20px; padding: 20px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: space-between; gap: 20px; }
        .date-nav-btn { background: #8b5cf6; color: white; border: none; border-radius: 12px; padding: 15px 25px; font-size: 1.5rem; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .date-nav-btn:hover { background: #7c3aed; transform: scale(1.05); }
        .date-nav-btn:active { transform: scale(0.95); }
        .date-nav-btn:disabled { background: #d1d5db; cursor: not-allowed; transform: scale(1); }
        .current-date { flex: 1; text-align: center; }
        .current-date h2 { font-size: 1.5rem; color: #374151; margin-bottom: 5px; }
        .current-date p { font-size: 0.9rem; color: #6b7280; }
        .viewing-past { background: #fef3c7; border: 2px solid #f59e0b; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; color: #92400e; font-weight: 600; }
        .scores { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .score-card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); transition: all 0.3s; }
        .score-card.today.negative { background: #ef4444; color: white; }
        .score-card.today.neutral { background: #f97316; color: white; }
        .score-card.today.positive { background: #10b981; color: white; }
        .score-card.total { background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%); color: white; }
        .score-label { font-size: 0.9rem; opacity: 0.9; margin-bottom: 10px; }
        .score-value { font-size: 3rem; font-weight: bold; margin-bottom: 5px; }
        .score-motivation { font-size: 1.1rem; font-weight: 600; margin-top: 10px; }
        .motivation-box { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .motivation-box h3 { font-size: 1.5rem; margin-bottom: 15px; }
        .motivation-box p { line-height: 1.6; margin-bottom: 15px; }
        .tip-box { background: rgba(255,255,255,0.2); border-radius: 10px; padding: 15px; }
        .milestones { margin-bottom: 30px; }
        .milestone { background: white; border-radius: 15px; padding: 20px; margin-bottom: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 15px; }
        .milestone-icon { font-size: 2rem; }
        .activities { background: white; border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .activities h2 { font-size: 1.8rem; margin-bottom: 20px; color: #374151; }
        .activity { border: 2px solid #e5e7eb; border-radius: 15px; padding: 20px; margin-bottom: 20px; transition: all 0.3s; }
        .activity:hover { border-color: #8b5cf6; }
        .activity-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .activity-name { font-size: 1.1rem; font-weight: 600; color: #374151; }
        .activity-points { padding: 5px 12px; border-radius: 8px; font-weight: bold; font-size: 0.9rem; }
        .points-positive { background: #d1fae5; color: #065f46; }
        .points-negative { background: #fee2e2; color: #991b1b; }
        .points-neutral { background: #f3f4f6; color: #6b7280; }
        .activity-buttons { display: grid; grid-template-columns: 1fr 1fr auto; gap: 10px; }
        .btn { padding: 15px; border: none; border-radius: 10px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn:active { transform: scale(0.95); }
        .btn-yes { background: #f3f4f6; color: #6b7280; }
        .btn-yes.active { background: #10b981; color: white; transform: scale(1.05); box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4); }
        .btn-no { background: #f3f4f6; color: #6b7280; }
        .btn-no.active { background: #ef4444; color: white; transform: scale(1.05); box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4); }
        .btn-reset { background: #e5e7eb; color: #6b7280; padding: 15px 20px; }
        .btn-reset:hover { background: #d1d5db; }
        .chart-container { background: white; border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .chart-container h2 { font-size: 1.8rem; margin-bottom: 20px; color: #374151; }
        .reset-btn { display: block; margin: 0 auto; padding: 15px 40px; background: #ef4444; color: white; border: none; border-radius: 15px; font-size: 1rem; font-weight: 600; cursor: pointer; box-shadow: 0 5px 15px rgba(239, 68, 68, 0.3); }
        .reset-btn:hover { background: #dc2626; }
        @media (max-width: 768px) {
            .scores { grid-template-columns: 1fr; }
            .header h1 { font-size: 2rem; }
            .score-value { font-size: 2.5rem; }
            .date-nav-btn { padding: 12px 20px; font-size: 1.2rem; }
            .current-date h2 { font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Lifestyle Score Tracker</h1>
            <p>Bouw aan een beter leven, √©√©n dag tegelijk</p>
            <p id="dateTime" style="margin-top: 10px; font-size: 1.1rem; opacity: 0.9;"></p>
        </div>
        
        <div class="date-navigator">
            <button class="date-nav-btn" onclick="navigateDay(-1)">‚óÄ</button>
            <div class="current-date">
                <h2 id="viewingDateDisplay">Vandaag</h2>
                <p id="viewingDateSub"></p>
            </div>
            <button class="date-nav-btn" id="nextDayBtn" onclick="navigateDay(1)">‚ñ∂</button>
        </div>
        
        <div id="viewingPastAlert" class="viewing-past" style="display: none;">
            ‚ö†Ô∏è Je bekijkt een dag uit het verleden. Wijzigingen worden opgeslagen.
        </div>
        
        <div class="scores">
            <div class="score-card today" id="todayCard">
                <div class="score-label" id="dayLabel">üìÖ Vandaag</div>
                <div class="score-value" id="todayScore">-2</div>
                <div class="score-label">Start: -2</div>
                <div class="score-motivation" id="todayMotivation"></div>
            </div>
            <div class="score-card total">
                <div class="score-label">üèÜ Totale Levensscore</div>
                <div class="score-value" id="totalScore">0</div>
            </div>
        </div>
        <div class="motivation-box" id="motivationBox"></div>
        <div class="milestones" id="milestones"></div>
        <div class="activities">
            <h2>üìä Dagelijkse Activiteiten</h2>
            <div id="activitiesList"></div>
        </div>
        <div class="chart-container">
            <h2>üìà Voortgang</h2>
            <canvas id="progressChart"></canvas>
        </div>
        <button class="reset-btn" onclick="resetAll()">Reset Alle Data</button>
    </div>
    <script>
        const STORAGE_KEY = 'lifestyle_tracker_v3';
        const categories = [
            { key: 'goodSleep', label: 'Goede Nachtrust', points: 1 },
            { key: 'sport', label: 'Sporten', points: 1 },
            { key: 'healthyEating', label: 'Gezond Eten', points: 1 },
            { key: 'meditation', label: 'Meditatie', points: 1 },
            { key: 'personalDevelopment', label: 'Persoonlijke Ontwikkeling', points: 1 },
            { key: 'noDrink', label: 'Geen Drank', pointsYes: 0, pointsNo: -2 },
            { key: 'noDrugs', label: 'Geen Drugs', pointsYes: 0, pointsNo: -2 }
        ];
        let state = { days: {}, baseTotalScore: 0, lastDate: null };
        let activities = {}, todayScore = -2, totalScore = 0, chart = null;
        let viewingDate = null; // null betekent vandaag
        
        const motivations = [
            { title: "üí™ Focus op Beweging", text: "Regelmatig sporten verbetert niet alleen je fysieke gezondheid, maar ook je mentale welzijn. Probeer elke dag minstens 30 minuten te bewegen.", tip: "Start klein: 10 push-ups elke ochtend kan al een grote impact hebben!" },
            { title: "ü•ó Voeding is de Basis", text: "Je lichaam is een tempel en voeding is de bouwsteen. Eet kleurrijk: hoe meer verschillende kleuren groenten en fruit op je bord, hoe beter.", tip: "Bereid je maaltijden voor op zondag, zo voorkom je ongezonde keuzes tijdens de week." },
            { title: "üßò Mindfulness Moment", text: "Meditatie hoeft niet ingewikkeld te zijn. Zelfs 5 minuten per dag bewust ademhalen kan stress verminderen en je focus verbeteren.", tip: "Probeer de '4-7-8' ademhalingstechniek: 4 tellen inademen, 7 vasthouden, 8 uitademen." },
            { title: "üò¥ Slaap is Superkracht", text: "Goede slaap is essentieel voor herstel, geheugen en emotionele balans. Probeer een vast slaapritme aan te houden, zelfs in het weekend.", tip: "Zet je telefoon een uur voor bedtijd weg en dim het licht. Maak een rustgevend avondritueel." },
            { title: "üìö Blijf Groeien", text: "Persoonlijke ontwikkeling is een levenslange reis. Of je nu een boek leest, een cursus volgt of een nieuwe vaardigheid leert - elke dag leren is elke dag groeien.", tip: "Lees 10 pagina's per dag. Dat zijn 3.650 pagina's per jaar - ongeveer 12 boeken!" },
            { title: "üö´ Alcohol & Bewustzijn", text: "Geen alcohol drinken geeft je helderheid, betere slaap en meer energie. Bewuste keuzes maken over wanneer en hoeveel je drinkt is krachtig.", tip: "Zoek alternatieven: probeer alcoholvrije cocktails of sparkling water met fruit." },
            { title: "üéØ Consistentie Wint", text: "Rome is niet in √©√©n dag gebouwd. De kleine, dagelijkse keuzes die je maakt stapelen zich op tot grote veranderingen.", tip: "Focus op progress, niet perfectie. Een 'slechte' dag maakt je niet tot een slecht persoon." }
        ];

        function getTodayKey() { const d = new Date(); return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`; }
        function getDateKey(date) { return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`; }
        function parseDateKey(key) { const [y,m,d] = key.split('-').map(Number); return new Date(y, m-1, d); }
        function saveToStorage() { try { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); return true; } catch(e) { return false; } }
        function loadFromStorage() { try { const d = localStorage.getItem(STORAGE_KEY); return d ? JSON.parse(d) : null; } catch(e) { return null; } }
        
        function navigateDay(offset) {
            const currentDate = viewingDate ? parseDateKey(viewingDate) : new Date();
            currentDate.setDate(currentDate.getDate() + offset);
            
            const newDateKey = getDateKey(currentDate);
            const today = getTodayKey();
            
            // Niet in de toekomst kijken
            if (newDateKey > today) return;
            
            viewingDate = newDateKey;
            loadDayData(viewingDate);
            updateUI();
            updateNavigationUI();
        }
        
        function updateNavigationUI() {
            const today = getTodayKey();
            const isToday = !viewingDate || viewingDate === today;
            
            // Disable next button als we vandaag bekijken
            document.getElementById('nextDayBtn').disabled = isToday;
            
            // Update datum display
            if (isToday) {
                document.getElementById('viewingDateDisplay').textContent = 'Vandaag';
                document.getElementById('viewingDateSub').textContent = formatDateNice(new Date());
                document.getElementById('viewingPastAlert').style.display = 'none';
                document.getElementById('dayLabel').textContent = 'üìÖ Vandaag';
            } else {
                const date = parseDateKey(viewingDate);
                const daysAgo = Math.floor((new Date() - date) / (1000 * 60 * 60 * 24));
                
                if (daysAgo === 1) {
                    document.getElementById('viewingDateDisplay').textContent = 'Gisteren';
                } else {
                    document.getElementById('viewingDateDisplay').textContent = formatDateNice(date);
                }
                document.getElementById('viewingDateSub').textContent = `${daysAgo} ${daysAgo === 1 ? 'dag' : 'dagen'} geleden`;
                document.getElementById('viewingPastAlert').style.display = 'block';
                document.getElementById('dayLabel').textContent = 'üìÖ Deze Dag';
            }
        }
        
        function formatDateNice(date) {
            const dagen = ['zondag', 'maandag', 'dinsdag', 'woensdag', 'donderdag', 'vrijdag', 'zaterdag'];
            const maanden = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];
            return `${dagen[date.getDay()]} ${date.getDate()} ${maanden[date.getMonth()]}`;
        }
        
        function loadDayData(dateKey) {
            const dayData = state.days[dateKey];
            if (dayData) {
                activities = {...dayData.activities};
                todayScore = dayData.score;
            } else {
                categories.forEach(c => activities[c.key] = null);
                todayScore = -2;
            }
        }

        function initializeApp() {
            const saved = loadFromStorage();
            if (saved) state = saved;
            else state = { days: {}, baseTotalScore: 0, lastDate: null };

            const today = getTodayKey(), last = state.lastDate;
            
            // Update base score bij nieuwe dag
            if (last && last !== today) {
                const yday = state.days[last];
                if (yday) state.baseTotalScore += yday.score;
                state.lastDate = today;
                saveToStorage();
            }
            
            // Laad vandaag
            viewingDate = null;
            const td = state.days[today];
            if (td) { 
                activities = {...td.activities}; 
                todayScore = td.score; 
            } else {
                categories.forEach(c => activities[c.key] = null);
                todayScore = -2;
                state.days[today] = { date: today, activities: {...activities}, score: todayScore };
                state.lastDate = today;
                saveToStorage();
            }
            
            // Bereken totaalscore (alle dagen tot gisteren + vandaag)
            totalScore = state.baseTotalScore + todayScore;
            
            updateNavigationUI();
            updateUI();
        }

        function calculateScore() {
            let s = -2;
            categories.forEach(c => {
                const v = activities[c.key];
                if (v === true) s += (c.key === 'noDrink' || c.key === 'noDrugs') ? c.pointsYes : c.points;
                else if (v === false && (c.key === 'noDrink' || c.key === 'noDrugs')) s += c.pointsNo;
            });
            return s;
        }

        function handleClick(key, val) {
            activities[key] = val;
            todayScore = calculateScore();
            
            const dateToUpdate = viewingDate || getTodayKey();
            state.days[dateToUpdate] = { date: dateToUpdate, activities: {...activities}, score: todayScore };
            
            // Herbereken totaalscore
            if (!viewingDate || viewingDate === getTodayKey()) {
                totalScore = state.baseTotalScore + todayScore;
            } else {
                // Als we een oude dag bewerken, herbereken vanaf scratch
                const sortedDates = Object.keys(state.days).sort();
                let runningTotal = 0;
                const today = getTodayKey();
                sortedDates.forEach(d => {
                    if (d < today) {
                        runningTotal += state.days[d].score;
                    }
                });
                state.baseTotalScore = runningTotal;
                const todayData = state.days[today];
                totalScore = state.baseTotalScore + (todayData ? todayData.score : -2);
            }
            
            saveToStorage();
            updateUI();
        }

        function updateUI() {
            document.getElementById('todayScore').textContent = (todayScore > 0 ? '+' : '') + todayScore;
            document.getElementById('totalScore').textContent = totalScore;
            updateDateTime();
            
            const tc = document.getElementById('todayCard');
            tc.classList.remove('negative', 'neutral', 'positive');
            if (todayScore < 0) tc.classList.add('negative');
            else if (todayScore === 0) tc.classList.add('neutral');
            else tc.classList.add('positive');
            
            let mot = '';
            if (todayScore >= 3) mot = 'üî• Perfecte dag! Je bent on fire!';
            else if (todayScore >= 1) mot = '‚ú® Goede dag! Je maakt vooruitgang!';
            else if (todayScore === 0) mot = 'üí™ Neutrale dag. Morgen kun je het beter doen!';
            else if (todayScore >= -2) mot = 'ü§î Lastige dag. Morgen is een nieuwe kans!';
            else mot = 'üíô Iedereen heeft mindere dagen. Blijf doorgaan!';
            document.getElementById('todayMotivation').textContent = mot;
            
            const doy = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
            const dm = motivations[doy % motivations.length];
            document.getElementById('motivationBox').innerHTML = `<h3>${dm.title}</h3><p>${dm.text}</p><div class="tip-box"><p><strong>üí° Tip van de dag:</strong></p><p>${dm.tip}</p></div>`;
            
            updateMilestones();
            updateActivitiesList();
            updateChart();
        }

        function updateMilestones() {
            const str = calculateStreaks(), m = [];
            if (str.goodSleep >= 7) m.push({ icon: 'üèÜ', text: `${str.goodSleep} dagen goede slaap op rij! Je lichaam bedankt je.` });
            if (str.sport >= 7) m.push({ icon: 'üí™', text: `${str.sport} dagen sporten! Je bouwt serieuze momentum op.` });
            if (str.healthyEating >= 7) m.push({ icon: 'ü•ó', text: `${str.healthyEating} dagen gezond eten! Je lichaam straalt het uit.` });
            if (str.meditation >= 7) m.push({ icon: 'üßò', text: `${str.meditation} dagen meditatie! Je mindset wordt steeds sterker.` });
            if (str.personalDevelopment >= 7) m.push({ icon: 'üìö', text: `${str.personalDevelopment} dagen persoonlijke ontwikkeling! Kennis is macht.` });
            if (totalScore >= 50) m.push({ icon: '‚≠ê', text: `Totaalscore van ${totalScore}! Je bent op de goede weg.` });
            document.getElementById('milestones').innerHTML = m.length > 0 ? m.map(x => `<div class="milestone"><div class="milestone-icon">${x.icon}</div><div>${x.text}</div></div>`).join('') : '';
        }

        function calculateStreaks() {
            const str = {}, pos = ['goodSleep', 'sport', 'healthyEating', 'meditation', 'personalDevelopment'];
            pos.forEach(k => {
                let s = 0;
                for (let i = 0; i < 30; i++) {
                    const d = new Date(); d.setDate(d.getDate() - i);
                    const dk = getDateKey(d);
                    const dd = state.days[dk];
                    if (dd && dd.activities[k] === true) s++; else break;
                }
                str[k] = s;
            });
            return str;
        }

        function updateActivitiesList() {
            document.getElementById('activitiesList').innerHTML = categories.map(c => {
                const v = activities[c.key];
                let dp = '', pc = 'points-neutral';
                if (c.key === 'noDrink' || c.key === 'noDrugs') {
                    dp = v === true ? '0' : v === false ? '-2' : '0';
                    pc = v === false ? 'points-negative' : 'points-neutral';
                } else {
                    dp = v === true ? '+1' : '0';
                    pc = v === true ? 'points-positive' : 'points-neutral';
                }
                return `<div class="activity"><div class="activity-header"><div class="activity-name">${c.label}</div><div class="activity-points ${pc}">${dp}</div></div><div class="activity-buttons"><button class="btn btn-yes ${v === true ? 'active' : ''}" onclick="handleClick('${c.key}', true)">JA</button><button class="btn btn-no ${v === false ? 'active' : ''}" onclick="handleClick('${c.key}', false)">NEE</button><button class="btn btn-reset" onclick="handleClick('${c.key}', null)">‚ü≤</button></div></div>`;
            }).join('');
        }

        function updateChart() {
            const hist = [], sd = Object.keys(state.days).sort();
            let rt = 0;
            sd.forEach(d => {
                if (d !== getTodayKey()) rt += state.days[d].score;
                const t = d === getTodayKey() ? state.baseTotalScore + state.days[d].score : rt;
                hist.push({ date: d, total: t });
            });
            
            const ctx = document.getElementById('progressChart');
            if (chart) chart.destroy();
            if (hist.length > 0) {
                chart = new Chart(ctx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: hist.slice(-30).map(h => { const p = h.date.split('-'); return `${p[2]}/${p[1]}`; }),
                        datasets: [{ label: 'Totale Score', data: hist.slice(-30).map(h => h.total), borderColor: '#8b5cf6', backgroundColor: 'rgba(139, 92, 246, 0.1)', tension: 0.4, fill: true, pointRadius: 5, pointHoverRadius: 7 }]
                    },
                    options: { responsive: true, maintainAspectRatio: true, plugins: { legend: { display: false } }, scales: { y: { ticks: { callback: v => Math.round(v) } } } }
                });
            }
        }

        function resetAll() {
            if (confirm('Weet je zeker dat je alle data wilt resetten?')) {
                try { localStorage.removeItem(STORAGE_KEY); } catch(e) {}
                state = { days: {}, baseTotalScore: 0, lastDate: getTodayKey() };
                categories.forEach(c => activities[c.key] = null);
                todayScore = -2; totalScore = -2;
                viewingDate = null;
                state.days[getTodayKey()] = { date: getTodayKey(), activities: {...activities}, score: todayScore };
                saveToStorage(); 
                updateNavigationUI();
                updateUI(); 
                alert('üîÑ Data is gereset!');
            }
        }

        function updateDateTime() {
            const n = new Date();
            const dag = ['zondag', 'maandag', 'dinsdag', 'woensdag', 'donderdag', 'vrijdag', 'zaterdag'];
            const mnd = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];
            const el = document.getElementById('dateTime');
            if (el) el.textContent = `${dag[n.getDay()]} ${n.getDate()} ${mnd[n.getMonth()]} ${n.getFullYear()} ‚Ä¢ ${String(n.getHours()).padStart(2,'0')}:${String(n.getMinutes()).padStart(2,'0')}`;
        }

        initializeApp();
        setInterval(updateDateTime, 1000);
    </script>
</body>
</html>
